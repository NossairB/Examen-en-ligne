<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Créer un Examen</title>
</head>
<body>
  <h1>Créer un Examen</h1>
  <form id="examForm">
    <label for="title">Titre de l'examen :</label>
    <input type="text" id="title" name="title" required><br>

    <label for="description">Description de l'examen :</label>
    <textarea id="description" name="description" required></textarea><br>

    <label for="target">Public Ciblé :</label>
    <input type="text" id="target" name="target" required><br>

    <button type="submit">Créer l'examen</button>
  </form>

  <div id="examLink"></div>

  <form id="examForm">
  <label for="type">Type de question :</label>
  <select id="type" name="type">
    <option value="direct">Question directe</option>
    <option value="qcm">QCM</option>
  </select><br><br>

  <label for="statement">Énoncé :</label>
  <textarea id="statement" name="statement"></textarea><br><br>

  <!-- Pour les questions directes -->
  <div id="directQuestionFields" style="display:none;">
    <label for="answer">Réponse :</label>
    <input type="text" id="answer" name="answer"><br><br>

    <label for="tolerance">Tolérance :</label>
    <input type="number" id="tolerance" name="tolerance" min="0" max="100" placeholder="Exemple : 10"><br><br>
  </div>

  <!-- Pour les QCM -->
  <div id="qcmFields" style="display:none;">
    <label for="options">Options :</label>
    <textarea id="options" name="options"></textarea><br><br>

    <label for="correctAnswers">Réponses correctes :</label>
    <input type="checkbox" name="correctAnswer" value="1"> Option 1
    <input type="checkbox" name="correctAnswer" value="2"> Option 2
    <input type="checkbox" name="correctAnswer" value="3"> Option 3<br><br>
  </div>

  <label for="note">Note :</label>
  <input type="number" id="note" name="note" min="0" max="100"><br><br>

  <label for="duration">Durée (en secondes) :</label>
  <input type="number" id="duration" name="duration" min="1"><br><br>

  <button type="submit">Créer l'examen</button>
</form>

<script>
  // JavaScript pour afficher les champs en fonction du type de question
  document.getElementById('type').addEventListener('change', function() {
    if (this.value === 'direct') {
      document.getElementById('directQuestionFields').style.display = 'block';
      document.getElementById('qcmFields').style.display = 'none';
    } else if (this.value === 'qcm') {
      document.getElementById('directQuestionFields').style.display = 'none';
      document.getElementById('qcmFields').style.display = 'block';
    }
  });
</script>


  <script>
    document.getElementById("examForm").addEventListener("submit", function(event) {
      event.preventDefault();

      const title = document.getElementById("title").value;
      const description = document.getElementById("description").value;
      const target = document.getElementById("target").value;

      fetch("http://localhost:3000/api/exams", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ title, description, target })
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById("examLink").innerHTML = `Examen créé avec succès. Voici le lien : <a href="${data.link}" target="_blank">${data.link}</a>`;
      })
      .catch(error => {
        console.error("Erreur lors de la création de l'examen:", error);
      });
    });
  </script>
</body>
</html>
